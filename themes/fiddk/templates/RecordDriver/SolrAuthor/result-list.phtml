<?php
  $heading = $this->driver->getTitle();
  if (empty($heading)) {
    $heading = $this->translate('Heading unavailable.');
  }
  $authType = $this->driver->getAuthType();

  $coverDetails = $this->record($this->driver)->getCoverDetails('result-list', 'medium', $this->recordLink()->getUrl($this->driver));
  $cover = $coverDetails['html'];
  $thumbnail = false;
  $thumbnailAlignment = $this->record($this->driver)->getThumbnailAlignment('result');
  if ($cover):
    ob_start(); ?>
      <div class="media-<?=$thumbnailAlignment ?> <?=$this->escapeHtmlAttr($coverDetails['size'])?>">
       <?=$cover ?>
      </div>
    <?php $thumbnail = ob_get_contents();
    ob_end_clean();?>
    <div class="media">
    <?php endif; ?>
    <?php if ($thumbnail): ?>
      <?=$thumbnail ?>
    <?php endif ?>

  <div class="media-body">
    <div class="resultItemLine1">
      <a href="<?=$this->recordLink()->getUrl($this->driver)?>" class="title"><?=$this->escapeHtml($heading)?></a>
    </div>
  <?php if ($authType == "Personal Name"): ?>
    <?php $prof = $this->driver->getOccupation();?>
    <?php $birth = $this->driver->getBirthDate();?>
    <?php $death = $this->driver->getDeathDate();?>
    <?php if (!empty($prof) || !empty($birth) || !empty($death)): ?>
      <div class="resultItemLine2">
      <?php if ($birth || $death) : ?>
          <? if (!$death) : ?>
              <?='* ' . $this->driver->translateDate($birth,'de')?><br/>
          <? elseif(!$birth) : ?>
              <?='† ' . $this->driver->translateDate($death,'de')?><br/>
          <? else : ?>
              <?='* ' . $this->driver->translateDate($birth,'de') . ' - † ' . $this->driver->translateDate($death,'de')?><br/>
          <? endif; ?>
      <? endif; ?>
      <?php foreach ($prof as $current): ?>
        <a href="<?=$this->url('agentsearch-results')?>?filter[]=occupation_facet%3A<?=urlencode($current)?>"><?=$this->escapeHtml($current)?></a> |
      <?php endforeach; ?>
      </div>
  <?php endif; ?>
  <?php elseif ($authType == "Corporate Name"): ?>
    <?php $domain = $this->driver->getOrgaDomain();?>
    <?php $birth = $this->driver->getBirthDate();?>
    <?php $death = $this->driver->getDeathDate();?>
    <?php if (!empty($domain)): ?>
      <div class="resultItemLine2">
        <?php if ($birth || $death) : ?>
            <? if (!$death) : ?>
                <?=$this->transEsc('since') . ' ' . $this->driver->translateDate($birth,'de')?><br/>
            <? elseif(!$birth) : ?>
                <?=$this->transEsc('until') . ' ' . $this->driver->translateDate($death,'de')?><br/>
            <? else : ?>
                <?=$this->driver->translateDate($birth,'de') . ' - ' . $this->driver->translateDate($death,'de')?><br/>
            <? endif; ?>
        <? endif; ?>
      <?php foreach ($domain as $current): ?>
        <a href="<?=$this->url('agentsearch-results')?>?filter[]=orga_domain%3A<?=urlencode($current)?>"><?=$this->escapeHtml($current)?></a> |
      <?php endforeach; ?>
      </div>
    <?php endif; ?>
  <?php endif; ?>
  </div>
</div>
